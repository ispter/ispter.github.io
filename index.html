<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="initial-scale=1, maximum-scale=1">
	<title>国家艺术基金资助项目_江山如画</title>
	<link rel="stylesheet" href="css/style.css">
	<script src="js/jquery.js"></script>
	<audio src="img/bgm.mp3"  id="bgMusic" loop autoplay> </audio>
</head>
<body>

<div class="container">

	<div class="box">
		<img src="img/pic.jpg" alt="" class="bg">

		<div class="part">
			<span>沈阳<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>长春<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>哈尔滨<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>西宁<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>兰州<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>银川<br> 2013-2019 AQI</span>
		</div>


		<div class="part">
			<span>西安<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>呼和浩特<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>太原<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>郑州<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>石家庄<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>济南<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>拉萨<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>昆明<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>成都<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>贵阳<br> 2013-2019 AQI</span>
		</div>
		
		<div class="part">
			<span>重庆<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>长沙<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>武汉<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>南昌<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>合肥<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>南京<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>杭州<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>上海<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>南宁<br> 2013-2019 AQI</span>
		</div>

		<div class="part">
			<span>广州<br> 2013-2019 AQI</span>
		</div>
		<div class="part">
			<span>乌鲁木齐<br> 2013-2019 AQI</span>
		</div>

	</div>
	
	<div class="control">
		<span class="music"></span>
		<span class="big"></span>
		<span class="small"></span>

		<span class="ctl"></span>
	</div>
</div>

<div class="cover">

</div>


<script>
$(function(){
	$('.cover').fadeIn(500);

	setTimeout(function(){
		$('.cover').fadeOut(500);
		$('.box').show();
		start();
	},6000);

	var flag=true;

	$('.part').on("touchstart",function(){
		$('.part').css("opacity",0);
		$(this).css("opacity",1);
	});


	function autoplay(){

		if($('.box').position().left>($(window).width()-$('.box').width())){
			$('.box').css({
				left:($('.box').position().left-4)+"px",
			});
		}else{
			stop();
		}

	}

	$('.ctl').click(function(){
		if(flag){
			stop();
		}else{
			start();
		}
	});

	var timer;

	var start=function(){
		$('.box').css({
			transform:'scale(1)',
		});

		$('.ctl').css('background-image','url(img/stop.png)');

		flag=true;

		timer=setInterval(function(){
			autoplay();
		},60);
	}

	var stop = function(){
		clearInterval(timer);
		$('.ctl').css('background-image','url(img/start.png)');
		flag = false;
	}

	var yan=function(){
		setTimeout(function(){
			$('.box').css({
				top:0,
			});
			start();

		},6000);
	}

	//start();


	
	$('.big').click(function(){
		stop();
		if($('.box').height()<(2*$(window).height())){
			$('.box').css({
				//transform:'scale('+(getZoomLeve('.box')+0.1)+')'
				height:$('.box').height()*1.1+"px",
			});
		}else{
			alert('最大能方法2倍');
		}

		console.log($('.box').css('left'));

		//yan();
		
	});

	$('.small').click(function(){
		stop();
		//if($('.box').height()>($(window).height())){
			$('.box').css({
				//transform:'scale('+(getZoomLeve('.box')-0.1)+')'
				height:$('.box').height()*0.9+"px",
			});
		// }else{
		// 	$('.box').css({
		// 		//transform:'scale(1)'
		// 		height:$(window).height()+"px",
		// 		top:0,
		// 	});
		// 	alert('缩小倍数不能小于1倍');
		// }

		//yan();
	});

	$('.box').mousedown(function(e){
		e.preventDefault();
		stop();

		var e=e||window.event;
		var that=this;
		var diffX=e.clientX-that.offsetLeft;
		var diffY=e.clientY-that.offsetTop;

		document.onmousemove=function(e){
			var e=e||window.event;
			var lft=e.clientX-diffX;
			var tp=e.clientY-diffY;
			if(lft>0){
				lft=0;
			}else if(lft<($(window).width()-$(that).width())){
				lft=$(window).width()-$(that).width();
			}
			// if(tp>0){
			// 	tp=0;
			// }else if(tp<($(window).height()-$(that).height())){
			// 	tp=$(window).height()-$(that).height();
			// }
			//console.log(lft);
			$(that).css({
				left:lft+'px',
				top:tp+'px',
			});
			
			stop();
		};

		document.onmouseup=function(){

			document.onmouseup=null;
			document.onmousemove=null;
			//start();
		};
	});


	$('.box').on("touchstart",function(e){
		e.preventDefault();
		stop();
		var that = this;

		var diffX = e.originalEvent.changedTouches[0].pageX - that.offsetLeft;

		var diffY = e.originalEvent.changedTouches[0].pageY - that.offsetTop;

		$('.box').on("touchmove",function(e){

			var e=e||window.event;

			var lft = e.originalEvent.changedTouches[0].pageX-diffX;

			var tp = e.originalEvent.changedTouches[0].pageY-diffY;

			if(lft>0){
				lft=0;
			}else if(lft<($(window).width()-$(that).width())){
				lft=$(window).width()-$(that).width();
			}

			// if(tp>0){
			// 	tp=0;
			// }else if(tp<($(window).height()-$(that).height())){
			// 	tp=$(window).height()-$(that).height();
			// }

			$(that).css({
				left:lft+'px',
				top:tp+'px',
			});
			
			stop();

		});

		

		


	});












	$(".music").click(function(){
		var bgm =$('#bgMusic')[0];
		if(bgm.paused){
			bgm.play();
			$(this).removeClass('on');
			
		}else{
			bgm.pause();
			$(this).addClass('on');
		}
	});





	function getZoomLeve(el) {
	    var sys=getBrowserInfo();
	    function getBrowserInfo(){
	        var Sys = {};
	        var ua = navigator.userAgent.toLowerCase();
	        var re =/(msie|firefox|chrome|opera|version).*?([\d.]+)/;
	        var m = ua.match(re);
	        Sys.browser = m[1].replace(/version/, "'safari");
	        Sys.ver = m[2];
	        return Sys;
	    }
	    //sys.browser得到浏览器的类型 sys.ver得到浏览器的版本
	    // 标示缩放的css属性  
	    var zoomPer, undefinedPer = 'none';
	    if(sys.browser.indexOf('firefox')!=-1) {
	        zoomPer = '-moz-transform';
	    }
	    else if(sys.browser.indexOf('ie')!=-1) {
	        if(sys.ver == '9') {
	            zoomPer = '-ms-transform';
	        } else {
	            zoomPer = 'zoom';
	            undefinedPer = 'normal';
	        }
	    }
	    else {
	        zoomPer = '-webkit-transform';
	    }
	    var ret = 1;
	    ret *= getZoom(el);
	    function getZoom(htmlEl) {
	        var ret = 1;
	        // 这里的add将el的缩放也计算在内  
	        if($(el).css(zoomPer) && $(el).css(zoomPer)!=undefinedPer) {
	            sys.ver==parseInt(sys.ver);
	            if(sys.browser.indexOf('ie')!=-1 && sys.ver < 9) {
	                ret *= el.style.zoom;
	            } else {
	                var temp = $(el).css(zoomPer),
	                    start = temp.indexOf('(') + 1,
	                    end = temp.indexOf(',');
	                ret *= temp.substring(start, end);
	            }
	        }
	        return ret;
	    }
	    return ret;
	}


})



</script>





	
</body>
</html>